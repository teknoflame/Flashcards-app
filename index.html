        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyFlow - Accessible Flashcards Study App</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>StudyFlow</h1>
            <p>Intelligent, accessible flashcards with spaced repetition - making studying seamless and engaging for everyone.</p>
            <div class="section" style="margin-top:10px;">
                <button id="open-help-btn" type="button">Help</button>
            </div>
        </header>


        <div aria-live="polite" aria-atomic="true" class="sr-only" id="announcements"></div>

        <nav class="nav-tabs" role="tablist">
            <button class="nav-tab active" role="tab" data-tab="decks" aria-selected="true">My Decks</button>
            <button class="nav-tab" role="tab" data-tab="create">Create Deck</button>
            <button class="nav-tab" role="tab" data-tab="study">Study Mode</button>
        </nav>

        <main>
            <!-- Decks Tab -->
            <section class="tab-content active" id="decks-tab" role="tabpanel">
                <h2>Your Study Decks</h2>
                <div class="section" aria-label="Folder actions">
                    <button id="add-folder-btn" type="button">Add Folder</button>
                </div>
                <div id="decks-list">
                    <div class="empty-state">
                        <h3>Welcome to StudyFlow!</h3>
                        <p>Create your first deck to get started studying.</p>
                        <button type="button" onclick="switchTab('create')">Create Your First Deck</button>
                    </div>
                </div>
            </section>

            <!-- Create Deck Tab -->
            <section class="tab-content" id="create-tab" role="tabpanel">
                <h2>Create New Deck</h2>
                
                <div class="section">
                    <label for="deck-name">Deck Name:</label>
                    <input type="text" id="deck-name" placeholder="e.g., Biology Chapter 5">
                    
                    <label for="deck-category">Category:</label>
                    <select id="deck-category">
                        <option value="Biology">Biology</option>
                        <option value="Chemistry">Chemistry</option>
                        <option value="Physics">Physics</option>
                        <option value="Math">Math</option>
                        <option value="History">History</option>
                        <option value="Other">Other</option>
                    </select>

                    <label for="deck-folder">Folder:</label>
                    <select id="deck-folder" aria-describedby="deck-folder-help">
                        <!-- options populated by JS -->
                    </select>
                    <div id="deck-folder-help" class="sr-only">Choose a folder to save this deck into. Select "New folderâ€¦" to create one.</div>
                </div>

                <div class="section">
                    <h3>Create Cards</h3>
                    <div class="button-group">
                        <button id="auto-method-btn" type="button">Auto-Generate from Notes</button>
                        <button id="manual-method-btn" type="button">Create Manually</button>
                    </div>
                </div>

                <div id="auto-input" class="section hidden">
                    <label for="notes-input">Paste your study notes here:</label>
                    <textarea id="notes-input" rows="10" placeholder="Example:
What is photosynthesis?
Photosynthesis is the process by which plants convert light energy into chemical energy.

Definition: Mitochondria
Mitochondria are the powerhouses of the cell."></textarea>
                    <button id="generate-btn" type="button">Generate Cards from Notes</button>
                </div>

                <div id="manual-input" class="section hidden">
                    <label for="card-front">Front of card (question or term):</label>
                    <textarea id="card-front" rows="3" placeholder="Example: What is mitosis?"></textarea>
                    
                    <label for="card-back">Back of card (answer or definition):</label>
                    <textarea id="card-back" rows="4" placeholder="Example: Mitosis is the process of cell division."></textarea>
                    
                    <button id="add-card-btn" type="button">Add This Card</button>
                </div>

                <div id="cards-preview" class="section hidden">
                    <h3>Cards Preview</h3>
                    <div id="preview-cards"></div>
                    <div class="button-group">
                        <button id="save-deck-btn" type="button">Save Deck</button>
                        <button id="cancel-deck-btn" type="button">Cancel</button>
                    </div>
                </div>
            </section>

            <script src="app.js" defer></script>
                updateConfirmState();

                // Select text for quick editing
                setTimeout(() => { inputEl.select(); }, 0);
            });
        };

        StudyFlowApp.prototype.openConfirmModal = function({ title, message, confirmText = 'OK', cancelText = 'Cancel' }) {
            return new Promise((resolve) => {
                this.modalTitle.textContent = title;
                this.modalDesc.textContent = message;
                this.modalContent.innerHTML = `<p>${message}</p>`;
                this.modalConfirmBtn.textContent = confirmText;
                this.modalCancelBtn.textContent = cancelText;
                this._openModalCommon({
                    initialFocus: this.modalConfirmBtn,
                    onConfirm: () => resolve(true),
                    onCancel: () => resolve(false),
                });
            });
        };

        // Internal modal open/close with focus trap
        StudyFlowApp.prototype._openModalCommon = function({ initialFocus, onConfirm, onCancel }) {
            // Save last focused element
            this._lastFocusedEl = document.activeElement;
            // Show modal
            this.modal.classList.remove('hidden');
            this.modalOverlay.classList.remove('hidden');
            this.modalOverlay.setAttribute('aria-hidden', 'false');
            // Hide main for AT
            if (this.appContainer) this.appContainer.setAttribute('aria-hidden', 'true');

            // Focus management
            const focusable = () => Array.from(this.modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(el => !el.disabled && el.offsetParent !== null);
            const keyHandler = (e) => {
                if (e.key === 'Escape') {
                    e.preventDefault();
                    doCancel();
                } else if (e.key === 'Tab') {
                    const els = focusable();
                    if (els.length === 0) return;
                    const first = els[0];
                    const last = els[els.length - 1];
                    if (e.shiftKey && document.activeElement === first) {
                        e.preventDefault();
                        last.focus();
                    } else if (!e.shiftKey && document.activeElement === last) {
                        e.preventDefault();
                        first.focus();
                    }
                }
            };
            document.addEventListener('keydown', keyHandler);

            const doConfirm = () => { this._restoreModalClose(); onConfirm && onConfirm(); };
            const doCancel = () => { this._restoreModalClose(); onCancel && onCancel(); };
            const clickOutside = (e) => { if (e.target === this.modalOverlay) doCancel(); };
            this.modalConfirmBtn.onclick = doConfirm;
            this.modalCancelBtn.onclick = doCancel;
            this.modalOverlay.addEventListener('click', clickOutside);

            // Set initial focus
            (initialFocus || this.modalConfirmBtn).focus();

            // Return cleanup handler to remove listeners when closing
            return () => {
                document.removeEventListener('keydown', keyHandler);
                this.modalOverlay.removeEventListener('click', clickOutside);
                this.modalConfirmBtn.onclick = null;
                this.modalCancelBtn.onclick = null;
            };
        };

        StudyFlowApp.prototype._restoreModalClose = function() {
            // Hide modal
            this.modal.classList.add('hidden');
            this.modalOverlay.classList.add('hidden');
            this.modalOverlay.setAttribute('aria-hidden', 'true');
            if (this.appContainer) this.appContainer.removeAttribute('aria-hidden');
            // Restore focus
            if (this._lastFocusedEl && typeof this._lastFocusedEl.focus === 'function') {
                this._lastFocusedEl.focus();
            }
        };

        // For backward compatibility
        StudyFlowApp.prototype._closeModal = function() {
            this._restoreModalClose();
        };
    </script>
</body>

</html>
