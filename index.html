        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Explicit referrer policy to ensure YouTube receives an origin (prevents error 153 when possible) -->
        <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>SparkDeck - Accessible Flashcards Study App</title>
<link rel="stylesheet" href="styles.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1, h2, h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .nav-tabs {
            display: flex;
            border-bottom: 2px solid #dee2e6;
            margin-bottom: 30px;
        }

        .nav-tab {
            background: none;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }

        .nav-tab:hover, .nav-tab:focus {
            background: #f8f9fa;
            outline: 2px solid #3498db;
            outline-offset: -2px;
        }

        .nav-tab.active {
            border-bottom-color: #3498db;
            color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: 30px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }

        input, textarea, select, button {
            width: 100%;
            padding: 12px;
            border: 2px solid #bdc3c7;
            border-radius: 4px;
            font-size: 16px;
            font-family: inherit;
        }

        input:focus, textarea:focus, select:focus, button:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        button {
            background: #3498db;
            color: white;
            border: 2px solid #3498db;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        button:hover {
            background: #2980b9;
            border-color: #2980b9;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .hidden {
            display: none !important;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .keyboard-help {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .keyboard-help h3 {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .keyboard-help ul {
            margin-left: 16px;
        }

        .keyboard-help li {
            margin-bottom: 5px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .deck-card {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.2s;
        }

        .deck-card:hover {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .deck-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .deck-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .flashcard {
            background: #fff;
            border: 3px solid #3498db;
            border-radius: 8px;
            padding: 30px;
            margin: 20px 0;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
        }

        .flashcard-content {
            font-size: 18px;
            line-height: 1.5;
            word-wrap: break-word;
            overflow-wrap: break-word;
            word-break: break-word;
            width: 100%;
            max-width: 100%;
        }

        .progress {
            text-align: center;
            margin-bottom: 20px;
            font-size: 16px;
            color: #2c3e50;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            transition: width 0.3s ease;
        }

        /* Help dialog styles (scoped to #help-modal) */
        #help-modal dialog::backdrop, #help-modal::backdrop {
            /* some UAs support dialog::backdrop; keep for safety */
            background: rgba(0,0,0,0.5);
        }
        #help-modal .modal-dialog {
            width: 96vw;
            max-width: none;
            height: 92vh;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 2px solid #3498db;
            display: flex;
            flex-direction: column;
        }
        #help-modal .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid #dee2e6;
        }
        #help-modal .modal-title {
            margin: 0;
            font-size: 20px;
        }
        #help-modal .modal-body {
            padding: 16px 20px 20px;
            flex: 1 1 auto;
            overflow: auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }
        #help-modal .modal-body ul,
        #help-modal .modal-body ol {
            display: inline-block;
            text-align: left;
            margin-left: 0;
        }
        #help-modal .close-btn {
            width: auto;
            padding: 8px 12px;
            background: transparent;
            color: #2c3e50;
            border: 2px solid #bdc3c7;
        }
        #help-modal .close-btn:hover {
            background: #f8f9fa;
        }

        /* Accessible generic modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.4);
            z-index: 1000;
        }

        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: min(600px, 90vw);
            background: #fff;
            border: 2px solid #3498db;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1001;
            padding: 20px;
        }

        .modal-header h2 {
            margin-bottom: 10px;
        }

        .modal-body {
            margin-bottom: 15px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .hidden[aria-hidden="true"] { display: none; }
        .media-embed-wrapper {
            margin-top: 12px;
            width: 100%;
            max-width: 100%;
        }

        /* Breadcrumb navigation */
        .breadcrumb-nav {
            margin-bottom: 20px;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            list-style: none;
            padding: 10px 0;
            margin: 0;
            flex-wrap: wrap;
        }

        .breadcrumb-item {
            font-size: 16px;
            color: #2c3e50;
            font-weight: 500;
        }

        .breadcrumb-item[aria-current="page"] {
            color: #6c757d;
        }

        .breadcrumb-link {
            background: none;
            border: none;
            padding: 4px 8px;
            color: #3498db;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            text-decoration: underline;
            width: auto;
            transition: all 0.2s;
        }

        .breadcrumb-link:hover, .breadcrumb-link:focus {
            color: #2980b9;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 4px;
            outline: 2px solid #3498db;
            outline-offset: 2px;
        }

        .breadcrumb-separator {
            margin: 0 8px;
            color: #6c757d;
            font-size: 16px;
            list-style: none;
        }

        /* Folder actions bar */
        .folder-actions-bar {
            margin-bottom: 20px;
        }

        .folder-actions-bar button {
            width: auto;
            padding: 10px 20px;
        }

        /* Folder card styles (drill-down UI) */
        .folders-section, .my-decks-section, .folder-decks-section, .subfolders-section {
            margin-bottom: 30px;
        }

        .folders-section h3, .my-decks-section h3, .folder-decks-section h3, .subfolders-section h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 10px;
        }

        .folder-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            margin-bottom: 15px;
            padding: 15px;
            transition: all 0.2s;
        }

        .folder-card:hover {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .folder-card-button {
            width: 100%;
            text-align: left;
            background: transparent;
            border: none;
            padding: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.2s;
        }

        .folder-card-button:hover, .folder-card-button:focus {
            background: rgba(52, 152, 219, 0.1);
            border-radius: 4px;
            outline: 2px solid #3498db;
            outline-offset: 2px;
        }

        .folder-card-icon {
            font-size: 48px;
            line-height: 1;
        }

        .folder-card-content {
            flex: 1;
        }

        .folder-card-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .folder-card-count {
            font-size: 14px;
            color: #6c757d;
            margin: 0;
        }

        .folder-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #dee2e6;
        }

        .folder-actions button {
            width: auto;
            padding: 8px 16px;
            font-size: 14px;
            background: transparent;
            color: #3498db;
            border: 2px solid #3498db;
        }

        .folder-actions button:hover, .folder-actions button:focus {
            background: #3498db;
            color: white;
        }

        .my-decks-section .deck-card {
            background: #fff;
        }

        /* Settings styles */
        .settings-section {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-section h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 18px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .setting-item label {
            margin-bottom: 0;
            font-weight: 500;
        }

        .setting-item button {
            width: auto;
            padding: 8px 16px;
        }

        .setting-description {
            color: #6c757d;
            margin-bottom: 15px;
        }

        /* Deck action menu styles */
        .deck-menu-container {
            position: relative;
        }

        .deck-menu-btn {
            width: auto;
            padding: 8px 12px;
            background: transparent;
            border: 2px solid #bdc3c7;
            color: #2c3e50;
            font-size: 18px;
            line-height: 1;
        }

        .deck-menu-btn:hover, .deck-menu-btn:focus {
            background: #f8f9fa;
            border-color: #3498db;
        }

        .deck-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 2px solid #3498db;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-width: 180px;
            z-index: 100;
            padding: 4px 0;
        }

        .deck-menu[hidden] {
            display: none;
        }

        .deck-menu-item {
            display: block;
            width: 100%;
            padding: 10px 16px;
            text-align: left;
            background: transparent;
            border: none;
            font-size: 15px;
            color: #2c3e50;
            cursor: pointer;
        }

        .deck-menu-item:hover, .deck-menu-item:focus {
            background: #e3f2fd;
            outline: none;
        }

        .deck-menu-item:focus {
            background: #3498db;
            color: white;
        }

        .deck-menu-separator {
            height: 1px;
            background: #dee2e6;
            margin: 4px 0;
        }

        .deck-menu-item--danger {
            color: #e74c3c;
        }

        .deck-menu-item--danger:focus {
            background: #e74c3c;
            color: white;
        }

        /* Study/Quiz Mode Overlay */
        .mode-overlay {
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.98);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .mode-overlay.hidden { display: none; }
        .mode-overlay-content {
            width: 100%;
            max-width: 700px;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border: 2px solid #3498db;
        }
        .mode-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #dee2e6;
        }
        .mode-header h2 { margin: 0; color: #2c3e50; }
        .mode-close-btn {
            width: auto;
            padding: 10px 20px;
            background: #e74c3c;
            border-color: #e74c3c;
        }
        .mode-close-btn:hover, .mode-close-btn:focus {
            background: #c0392b;
            border-color: #c0392b;
        }
        .study-controls { justify-content: center; margin-top: 20px; }

        /* Quiz styles */
        .quiz-question-container { margin: 20px 0; }
        .quiz-question {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 20px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .quiz-options { display: flex; flex-direction: column; gap: 12px; }
        .quiz-option {
            display: flex;
            align-items: flex-start;
            padding: 15px 20px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            font-size: 16px;
            width: 100%;
        }
        .quiz-option:hover, .quiz-option:focus {
            border-color: #3498db;
            background: #e3f2fd;
            outline: none;
        }
        .quiz-option:focus { box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3); }
        .quiz-option.correct { border-color: #27ae60; background: #d4edda; }
        .quiz-option.incorrect { border-color: #e74c3c; background: #f8d7da; }
        .quiz-option.disabled { pointer-events: none; opacity: 0.8; }
        .quiz-option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: #3498db;
            color: white;
            border-radius: 50%;
            font-weight: 600;
            margin-right: 15px;
            flex-shrink: 0;
            margin-top: 2px;
        }
        .quiz-option.correct .quiz-option-letter { background: #27ae60; }
        .quiz-option.incorrect .quiz-option-letter { background: #e74c3c; }
        .quiz-option-text { flex: 1; word-wrap: break-word; overflow-wrap: break-word; line-height: 1.5; }
        .quiz-written { display: flex; flex-direction: column; gap: 15px; }
        .quiz-written input { font-size: 18px; padding: 15px; text-align: center; }
        .quiz-feedback { text-align: center; padding: 20px; border-radius: 8px; margin-top: 20px; }
        .quiz-feedback.correct { background: #d4edda; border: 2px solid #27ae60; }
        .quiz-feedback.incorrect { background: #f8d7da; border: 2px solid #e74c3c; }
        #quiz-feedback-text { font-size: 24px; font-weight: 700; margin-bottom: 10px; }
        .quiz-feedback.correct #quiz-feedback-text { color: #27ae60; }
        .quiz-feedback.incorrect #quiz-feedback-text { color: #e74c3c; }
        .quiz-correct-answer { font-size: 16px; color: #555; margin-bottom: 15px; }
        #quiz-next-btn { width: auto; padding: 12px 30px; }
        .quiz-results-content { text-align: center; }
        .quiz-score { font-size: 64px; font-weight: 700; color: #3498db; margin: 30px 0 10px; }
        .quiz-score.excellent { color: #27ae60; }
        .quiz-score.good { color: #3498db; }
        .quiz-score.needs-work { color: #f39c12; }
        .quiz-score.poor { color: #e74c3c; }
        .quiz-score-breakdown { font-size: 18px; color: #555; margin-bottom: 30px; }
        .quiz-results-actions { justify-content: center; }
        #quiz-retry-btn { background: #27ae60; border-color: #27ae60; }
        #quiz-retry-btn:hover, #quiz-retry-btn:focus { background: #219a52; border-color: #219a52; }
        .quiz-mode-options { display: flex; flex-direction: column; gap: 12px; }
        .quiz-mode-option {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .quiz-mode-option:hover { border-color: #3498db; background: #e3f2fd; }
        .quiz-mode-option:has(input:checked) { border-color: #3498db; background: #e3f2fd; }
        .quiz-mode-option:has(input:focus) { box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3); }
        .quiz-mode-option input[type="radio"] { width: auto; margin-right: 12px; margin-top: 3px; flex-shrink: 0; }
        .quiz-mode-label { display: flex; flex-direction: column; gap: 4px; }
        .quiz-mode-label strong { font-size: 16px; color: #2c3e50; }
        .quiz-mode-label span { font-size: 14px; color: #6c757d; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
</style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SparkDeck</h1>
            <p>Intelligent, accessible flashcards with spaced repetition - making studying seamless and engaging for everyone.</p>
            <div class="section" style="margin-top:10px;">
                <button id="open-help-btn" type="button">Help</button>
            </div>
        </header>


        <div aria-live="polite" aria-atomic="true" class="sr-only" id="announcements"></div>

        <nav class="nav-tabs" role="tablist">
            <button class="nav-tab active" role="tab" data-tab="decks" aria-selected="true">My Decks</button>
            <button class="nav-tab" role="tab" data-tab="create">Create Deck</button>
            <button class="nav-tab" role="tab" data-tab="settings">Settings</button>
        </nav>

        <main>
            <!-- Decks Tab -->
            <section class="tab-content active" id="decks-tab" role="tabpanel">
                <h2>Your Study Decks</h2>
                <div class="section" aria-label="Folder actions">
                    <button id="add-folder-btn" type="button">Add Folder</button>
                </div>
                <div id="decks-list">
                    <div class="empty-state">
                        <h3>Welcome to SparkDeck!</h3>
                        <p>Create your first deck to get started studying.</p>
                        <button type="button" onclick="switchTab('create')">Create Your First Deck</button>
                    </div>
                </div>
            </section>

            <!-- Create Deck Tab -->
            <section class="tab-content" id="create-tab" role="tabpanel">
                <h2>Create New Deck</h2>
                
                <div class="section">
                    <label for="deck-name">Deck Name:</label>
                    <input type="text" id="deck-name" placeholder="e.g., Biology Chapter 5">
                    
                    <label for="deck-category">Category:</label>
                    <select id="deck-category">
                        <option value="Biology">Biology</option>
                        <option value="Chemistry">Chemistry</option>
                        <option value="Physics">Physics</option>
                        <option value="Math">Math</option>
                        <option value="History">History</option>
                        <option value="Other">Other</option>
                    </select>

                    <label for="deck-folder">Folder:</label>
                    <select id="deck-folder" aria-describedby="deck-folder-help">
                        <!-- options populated by JS -->
                    </select>
                    <div id="deck-folder-help" class="sr-only">Choose a folder to save this deck into. Select "New folder‚Ä¶" to create one.</div>
                </div>

                <div class="section">
                    <h3>Create Cards</h3>
                    <div class="button-group">
                        <button id="auto-method-btn" type="button">Auto-Generate from Notes</button>
                        <button id="manual-method-btn" type="button">Create Manually</button>
                    </div>
                </div>

                <div id="auto-input" class="section hidden">
                    <label for="notes-input">Paste your study notes here:</label>
                    <textarea id="notes-input" rows="10" placeholder="Example:
What is photosynthesis?
Photosynthesis is the process by which plants convert light energy into chemical energy.

Definition: Mitochondria
Mitochondria are the powerhouses of the cell."></textarea>
                    <button id="generate-btn" type="button">Generate Cards from Notes</button>
                </div>

                <div id="manual-input" class="section hidden">
                    <label for="card-front">Front of card (question or term):</label>
                    <textarea id="card-front" rows="3" placeholder="Example: What is mitosis?"></textarea>
                    
                    <label for="card-back">Back of card (answer or definition):</label>
                    <textarea id="card-back" rows="4" placeholder="Example: Mitosis is the process of cell division."></textarea>
                    
                    <label for="card-media">Optional media URL (YouTube link, Google Drive, etc.)</label>
                    <input type="url" id="card-media" placeholder="https://www.youtube.com/watch?v=..." aria-describedby="card-media-help">
                    <div id="card-media-help" class="sr-only">Provide a link to a video or file. You can preview it after adding the card. Supported: YouTube (embedded). Other services will open in a viewer.</div>
                    
                    <button id="add-card-btn" type="button">Add This Card</button>
                </div>

                <div id="cards-preview" class="section hidden">
                    <h3>Cards Preview</h3>
                    <div id="preview-cards"></div>
                    <div class="button-group">
                        <button id="save-deck-btn" type="button">Save Deck</button>
                        <button id="cancel-deck-btn" type="button">Cancel</button>
                    </div>
                </div>
            </section>

            <!-- Settings Tab -->
            <section class="tab-content" id="settings-tab" role="tabpanel">
                <h2>Settings</h2>

                <div class="settings-section">
                    <h3>Sound</h3>
                    <div class="setting-item">
                        <label for="mute-toggle-btn">Sound Effects</label>
                        <button id="mute-toggle-btn" type="button" aria-label="Toggle sound effects">üîä Enabled</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Data Management</h3>
                    <p class="setting-description">Import and export your decks and folders for backup or sharing.</p>
                    <div class="button-group">
                        <button id="import-btn" type="button" onclick="app.triggerImport()">Import Data</button>
                        <button id="export-all-btn" type="button" onclick="app.exportAllData()">Export All Data</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Study Mode Overlay -->
    <div id="study-overlay" class="mode-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="study-overlay-title">
        <div class="mode-overlay-content">
            <header class="mode-header">
                <h2 id="study-overlay-title">Study Mode</h2>
                <button id="end-study-btn" type="button" class="mode-close-btn" aria-label="End study session">End Study</button>
            </header>
            <div class="progress" id="study-progress" aria-live="polite"></div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
            </div>

            <div class="flashcard" id="flashcard" tabindex="0" role="button" aria-label="Flashcard - press Space or Enter to flip">
                <div class="flashcard-content" id="card-content"></div>
            </div>

            <div class="button-group study-controls">
                <button id="prev-btn" type="button">Previous</button>
                <button id="flip-btn" type="button">Flip Card</button>
                <button id="next-btn" type="button">Next</button>
            </div>
        </div>
    </div>

    <!-- Quiz Mode Overlay -->
    <div id="quiz-overlay" class="mode-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="quiz-overlay-title">
        <div class="mode-overlay-content">
            <header class="mode-header">
                <h2 id="quiz-overlay-title">Quiz Mode</h2>
                <button id="end-quiz-btn" type="button" class="mode-close-btn" aria-label="End quiz">End Quiz</button>
            </header>
            <div class="progress" id="quiz-progress" aria-live="polite"></div>
            <div class="progress-bar">
                <div class="progress-fill quiz-progress-fill" id="quiz-progress-fill" style="width: 0%"></div>
            </div>

            <div id="quiz-question-container" class="quiz-question-container">
                <div class="quiz-question" id="quiz-question"></div>

                <!-- Multiple Choice Options -->
                <div id="quiz-mc-options" class="quiz-options hidden" role="radiogroup" aria-label="Answer options">
                </div>

                <!-- Written Answer Input -->
                <div id="quiz-written-input" class="quiz-written hidden">
                    <label for="quiz-answer-input" class="sr-only">Your answer</label>
                    <input type="text" id="quiz-answer-input" placeholder="Type your answer..." autocomplete="off">
                    <button id="quiz-submit-answer" type="button">Submit Answer</button>
                </div>

                <!-- Feedback Area -->
                <div id="quiz-feedback" class="quiz-feedback hidden" role="status" aria-live="polite">
                    <div id="quiz-feedback-text"></div>
                    <div id="quiz-correct-answer" class="quiz-correct-answer"></div>
                    <button id="quiz-next-btn" type="button">Next Question</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Results Overlay -->
    <div id="quiz-results-overlay" class="mode-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="quiz-results-title">
        <div class="mode-overlay-content quiz-results-content">
            <h2 id="quiz-results-title">Quiz Complete!</h2>
            <div class="quiz-score" id="quiz-score"></div>
            <div class="quiz-score-breakdown" id="quiz-score-breakdown"></div>
            <div class="button-group quiz-results-actions">
                <button id="quiz-retry-btn" type="button">Try Again</button>
                <button id="quiz-back-btn" type="button">Back to Decks</button>
            </div>
        </div>
    </div>

    <!-- Help Modal (dialog) -->
    <dialog id="help-modal" aria-labelledby="help-title" aria-describedby="help-description">
        <div class="modal-dialog">
            <div class="modal-header">
                <h1 id="help-title" class="modal-title">Help</h1>
                <button id="close-help-btn" type="button" class="close-btn" aria-label="Close help">Close</button>
            </div>
            <div id="help-description" class="modal-body">
                <p>Welcome to SparkDeck. This Help covers how to navigate the app, create decks, and study efficiently with keyboard shortcuts.</p>

                <h2>Overview</h2>
                <p>SparkDeck lets you create flashcard decks, generate cards from notes, and study them with accessible controls and progress tracking.</p>

                <h2>Settings</h2>
                <p>Access Settings from the navigation tabs to:</p>
                <ul>
                    <li><strong>Sound Effects:</strong> Toggle sounds on/off</li>
                    <li><strong>Import Data:</strong> Load decks from a SparkDeck JSON file</li>
                    <li><strong>Export All:</strong> Backup all your decks and folders</li>
                </ul>

                <h2>Deck Actions</h2>
                <p>Each deck has Study and Quiz buttons:</p>
                <ul>
                    <li><strong>Study:</strong> Flip through shuffled flashcards at your own pace</li>
                    <li><strong>Quiz:</strong> Test yourself with multiple choice, written answers, or mixed mode</li>
                </ul>
                <p>Click the ‚ãÆ menu button for more options:</p>
                <ul>
                    <li><strong>Export:</strong> Download the deck as a JSON file</li>
                    <li><strong>Move to Folder:</strong> Organize your deck</li>
                    <li><strong>Delete:</strong> Remove the deck</li>
                </ul>

                <h2>Quiz Mode</h2>
                <p>Quiz mode tests your knowledge with instant feedback and scoring:</p>
                <ul>
                    <li><strong>Multiple Choice:</strong> Pick the correct answer from 4 options</li>
                    <li><strong>Written:</strong> Type your answer (accepts similar answers)</li>
                    <li><strong>Mixed:</strong> Random combination of both types</li>
                </ul>
                <p>You need at least 4 cards in a deck to start a quiz.</p>

                <h2>Keyboard Shortcuts</h2>
                <h3>Navigation</h3>
                <ul>
                    <li><strong>D:</strong> Go to My Decks</li>
                    <li><strong>C or N:</strong> Create new deck</li>
                    <li><strong>F:</strong> Create new folder</li>
                    <li><strong>S:</strong> Start studying first deck</li>
                    <li><strong>1-9:</strong> Quick study deck by number</li>
                    <li><strong>?:</strong> Open Help</li>
                    <li><strong>Escape:</strong> Close dialogs, end study, or end quiz</li>
                </ul>

                <h3>During Study</h3>
                <ul>
                    <li><strong>‚Üê / ‚Üí:</strong> Previous / Next card</li>
                    <li><strong>Space/Enter:</strong> Flip the current card</li>
                </ul>

                <h3>During Quiz</h3>
                <ul>
                    <li><strong>Enter:</strong> Submit written answer</li>
                    <li><strong>Escape:</strong> End quiz early</li>
                </ul>

                <h3>General</h3>
                <ul>
                    <li><strong>Tab/Shift+Tab:</strong> Move between interactive elements</li>
                    <li><strong>Space/Enter:</strong> Activate buttons</li>
                </ul>

                <h2>Creating Decks</h2>
                <ol>
                    <li>Go to ‚ÄúCreate Deck‚Äù.</li>
                    <li>Enter a deck name and pick a category.</li>
                    <li>Choose to auto-generate from your notes or create cards manually.</li>
                    <li>Preview and save when ready.</li>
                </ol>

                <h2>Studying Cards</h2>
                <ul>
                    <li>Select a deck from "My Decks", then choose "Study".</li>
                    <li>Cards are automatically shuffled for better learning.</li>
                    <li>Use Flip to switch between front and back.</li>
                    <li>Use Previous/Next or arrow keys to move through cards.</li>
                    <li>Progress updates are announced and shown visually.</li>
                </ul>
            </div>
        </div>
    </dialog>

    <!-- Accessible generic modal elements (used for prompts/confirmations) -->
    <div id="modal-overlay" class="modal-overlay hidden" aria-hidden="true"></div>
    <div id="app-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-desc">
        <div class="modal-header">
            <h2 id="modal-title">Dialog</h2>
        </div>
        <div class="modal-body">
            <p id="modal-desc" class="sr-only"></p>
            <div id="modal-content"></div>
        </div>
        <div class="modal-footer button-group">
            <button id="modal-cancel-btn" type="button">Cancel</button>
            <button id="modal-confirm-btn" type="button">Confirm</button>
        </div>
    </div>

    <script src="app.js" defer></script>
</body>

</html>
